{"ast":null,"code":"/*! @azure/msal-browser v3.5.0 2023-11-07 */\n'use strict';\n\nimport { BaseOperatingContext } from './BaseOperatingContext.mjs';\nimport { BridgeProxy } from '../naa/BridgeProxy.mjs';\n\n/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\nclass TeamsAppOperatingContext extends BaseOperatingContext {\n  constructor() {\n    super(...arguments);\n    this.bridgeProxy = undefined;\n    this.activeAccount = undefined;\n  }\n  /**\n   * Return the module name.  Intended for use with import() to enable dynamic import\n   * of the implementation associated with this operating context\n   * @returns\n   */\n  getModuleName() {\n    return TeamsAppOperatingContext.MODULE_NAME;\n  }\n  /**\n   * Returns the unique identifier for this operating context\n   * @returns string\n   */\n  getId() {\n    return TeamsAppOperatingContext.ID;\n  }\n  getBridgeProxy() {\n    return this.bridgeProxy;\n  }\n  getActiveAccount() {\n    return this.activeAccount;\n  }\n  setActiveAccount(account) {\n    this.activeAccount = account;\n  }\n  /**\n   * Checks whether the operating context is available.\n   * Confirms that the code is running a browser rather.  This is required.\n   * @returns Promise<boolean> indicating whether this operating context is currently available.\n   */\n  async initialize() {\n    /*\n     * TODO: Add implementation to check for presence of inject Nested App Auth Bridge JavaScript interface\n     *\n     */\n    try {\n      if (typeof window !== \"undefined\") {\n        const bridgeProxy = await BridgeProxy.create();\n        /*\n         * Because we want single sign on we need to attempt to\n         * grab the active account as part of initialization\n         * this.activeAccount = await bridgeProxy.getActiveAccount();\n         */\n        try {\n          this.activeAccount = await bridgeProxy.getActiveAccount();\n        } catch (e) {\n          this.activeAccount = undefined;\n        }\n        this.bridgeProxy = bridgeProxy;\n        this.available = bridgeProxy !== undefined;\n      } else {\n        this.available = false;\n      }\n    } catch (e) {\n      this.available = false;\n    } finally {\n      return this.available;\n    }\n  }\n}\n/*\n * TODO: Once we have determine the bundling code return here to specify the name of the bundle\n * containing the implementation for this operating context\n */\nTeamsAppOperatingContext.MODULE_NAME = \"\";\n/**\n * Unique identifier for the operating context\n */\nTeamsAppOperatingContext.ID = \"TeamsAppOperatingContext\";\nexport { TeamsAppOperatingContext };","map":{"version":3,"names":["TeamsAppOperatingContext","BaseOperatingContext","constructor","bridgeProxy","undefined","activeAccount","getModuleName","getId","ID","getActiveAccount"],"sources":["D:\\react-typescript\\intelli-gui\\node_modules\\@azure\\msal-browser\\src\\operatingcontext\\TeamsAppOperatingContext.ts"],"sourcesContent":["/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport { BaseOperatingContext } from \"./BaseOperatingContext\";\nimport { IBridgeProxy } from \"../naa/IBridgeProxy\";\nimport { BridgeProxy } from \"../naa/BridgeProxy\";\nimport { AccountInfo } from \"../naa/AccountInfo\";\n\nexport class TeamsAppOperatingContext extends BaseOperatingContext {\n    protected bridgeProxy: IBridgeProxy | undefined = undefined;\n    protected activeAccount: AccountInfo | undefined = undefined;\n\n    /*\n     * TODO: Once we have determine the bundling code return here to specify the name of the bundle\n     * containing the implementation for this operating context\n     */\n    static readonly MODULE_NAME: string = \"\";\n\n    /**\n     * Unique identifier for the operating context\n     */\n    static readonly ID: string = \"TeamsAppOperatingContext\";\n\n    /**\n     * Return the module name.  Intended for use with import() to enable dynamic import\n     * of the implementation associated with this operating context\n     * @returns\n     */\n    getModuleName(): string {\n        return TeamsAppOperatingContext.MODULE_NAME;\n    }\n    /**\n     * Returns the unique identifier for this operating context\n     * @returns string\n     */\n    getId(): string {\n        return TeamsAppOperatingContext.ID;\n    }\n\n    getBridgeProxy(): IBridgeProxy | undefined {\n        return this.bridgeProxy;\n    }\n\n    getActiveAccount(): AccountInfo | undefined {\n        return this.activeAccount;\n    }\n\n    setActiveAccount(account: AccountInfo): void {\n        this.activeAccount = account;\n    }\n\n    /**\n     * Checks whether the operating context is available.\n     * Confirms that the code is running a browser rather.  This is required.\n     * @returns Promise<boolean> indicating whether this operating context is currently available.\n     */\n    async initialize(): Promise<boolean> {\n        /*\n         * TODO: Add implementation to check for presence of inject Nested App Auth Bridge JavaScript interface\n         *\n         */\n        try {\n            if (typeof window !== \"undefined\") {\n                const bridgeProxy: IBridgeProxy = await BridgeProxy.create();\n                /*\n                 * Because we want single sign on we need to attempt to\n                 * grab the active account as part of initialization\n                 * this.activeAccount = await bridgeProxy.getActiveAccount();\n                 */\n                try {\n                    this.activeAccount = await bridgeProxy.getActiveAccount();\n                } catch (e) {\n                    this.activeAccount = undefined;\n                }\n                this.bridgeProxy = bridgeProxy;\n                this.available = bridgeProxy !== undefined;\n            } else {\n                this.available = false;\n            }\n        } catch (e) {\n            this.available = false;\n        } finally {\n            return this.available;\n        }\n    }\n}\n"],"mappings":";;;;;;AAKA;AACA;AAEA;AAEA;AAQI,MAAeA,wBAAA,SAA0BC,oBAAA;EAEzCC,YAAA;;IAEG,KAAAC,WAAA,GAAAC,SAAA;IACH,IAAe,CAAAC,aAAA,GAAAD,SAAyC;EAExD;;;;AAIG;AACH;EAGAE,cAAA;;;EAGG;AACH;;;EAYAC,MAAA;IAIA,OAAAP,wBAAA,CAAAQ,EAAA;;;;EAIG;EACGC,gBAAcA,CAAA;IA6BvB,YAAAJ,aAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}